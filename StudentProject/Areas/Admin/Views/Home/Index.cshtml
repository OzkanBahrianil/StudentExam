@using X.PagedList
@using X.PagedList.Mvc.Core
@model IPagedList<EntityLayer.Concrate.AppUser>
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script src='https://kit.fontawesome.com/a076d05399.js' crossorigin='anonymous'></script>

<div class="card mb-4">
    <div class="card-header">
        <i class="fas fa-table me-1"></i>
        Öğrenci Rol Listesi
    </div>
    <div class="card-body">
        <div>
            <form class="d-flex align-items-center h-100" method="get">
                <div class="input-group">
                    <input type="hidden" name="PageSize" value="@ViewBag.psize" />
                    <input type="text" class="form-control bg-transparent border-0" value="@ViewData["CurrentFilterSearch"]" name="SearchString" placeholder="Search...">
                </div>
            </form>
        </div>
        <table class="table table-responsive-lg table-responsive">
            <thead>
                <tr>
                    <th>
                        <a style="color:black;" asp-action="Index" asp-route-sortOrder="@ViewData["NameSortParam"]" asp-route-PageSize="@ViewBag.psize" asp-route-SearchString="@ViewData["CurrentFilterSearch"]">İsim</a>
                        @if (ViewData["CurrentSort"] != null)
                        {


                            @if (ViewData["CurrentSort"].ToString() == "Name")
                            {
                                <i class="fas fa-angle-double-down"></i>
                            }
                            else if (ViewData["CurrentSort"].ToString() == "NameDesc")
                            {
                                <i class="fas fa-angle-double-up"></i>
                            }
                            else
                            {
                                <i class="fas fa-angle-double-right"></i>
                            }
                        }
                        else
                        {
                            <i class="fas fa-angle-double-left"></i>
                        }
                    </th>
                    <th>
                        <a style="color:black;" asp-action="Index" asp-route-sortOrder="@ViewData["SurnameSortParam"]" asp-route-PageSize="@ViewBag.psize" asp-route-SearchString="@ViewData["CurrentFilterSearch"]">Soyisim</a>
                        @if (ViewData["CurrentSort"] != null)
                        {


                            @if (ViewData["CurrentSort"].ToString() == "Surname")
                            {
                                <i class="fas fa-angle-double-down"></i>
                            }
                            else if (ViewData["CurrentSort"].ToString() == "SurnameDesc")
                            {
                                <i class="fas fa-angle-double-up"></i>
                            }
                            else
                            {
                                <i class="fas fa-angle-double-right"></i>
                            }
                        }
                        else
                        {
                            <i class="fas fa-angle-double-left"></i>
                        }
                    </th>

                    <th>
                        <a style="color:black;" asp-action="Index" asp-route-sortOrder="@ViewData["NumberSortParam"]" asp-route-SearchString="@ViewData["CurrentFilterSearch"]">Öğrenci Numarası</a>
                        @if (ViewData["CurrentSort"] != null)
                        {


                            @if (ViewData["CurrentSort"].ToString() == "Number")
                            {
                                <i class="fas fa-angle-double-down"></i>
                            }
                            else if (ViewData["CurrentSort"].ToString() == "NumberDesc")
                            {
                                <i class="fas fa-angle-double-up"></i>
                            }
                            else
                            {
                                <i class="fas fa-angle-double-right"></i>
                            }
                        }
                        else
                        {
                            <i class="fas fa-angle-double-left"></i>
                        }
                    </th>
                    <th>
                        <a style="color:black;" asp-action="Index" asp-route-sortOrder="@ViewData["FacultySortParam"]" asp-route-PageSize="@ViewBag.psize" asp-route-SearchString="@ViewData["CurrentFilterSearch"]">Fakülte</a>
                        @if (ViewData["CurrentSort"] != null)
                        {


                            @if (ViewData["CurrentSort"].ToString() == "Faculty")
                            {
                                <i class="fas fa-angle-double-down"></i>
                            }
                            else if (ViewData["CurrentSort"].ToString() == "FacultyDesc")
                            {
                                <i class="fas fa-angle-double-up"></i>
                            }
                            else
                            {
                                <i class="fas fa-angle-double-right"></i>
                            }
                        }
                        else
                        {
                            <i class="fas fa-angle-double-left"></i>
                        }
                    </th>
                    <th>
                        <a style="color:black;" asp-action="Index" asp-route-sortOrder="@ViewData["SectionSortParam"]" asp-route-PageSize="@ViewBag.psize" asp-route-SearchString="@ViewData["CurrentFilterSearch"]">Bölüm</a>
                        @if (ViewData["CurrentSort"] != null)
                        {


                            @if (ViewData["CurrentSort"].ToString() == "Section")
                            {
                                <i class="fas fa-angle-double-down"></i>
                            }
                            else if (ViewData["CurrentSort"].ToString() == "SectionDesc")
                            {
                                <i class="fas fa-angle-double-up"></i>
                            }
                            else
                            {
                                <i class="fas fa-angle-double-right"></i>
                            }
                        }
                        else
                        {
                            <i class="fas fa-angle-double-left"></i>
                        }
                    </th>
                    <th>
                        <a style="color:black;" asp-action="Index" asp-route-sortOrder="@ViewData["EmailSortParam"]" asp-route-PageSize="@ViewBag.psize" asp-route-SearchString="@ViewData["CurrentFilterSearch"]">Email</a>
                        @if (ViewData["CurrentSort"] != null)
                        {


                            @if (ViewData["CurrentSort"].ToString() == "Email")
                            {
                                <i class="fas fa-angle-double-down"></i>
                            }
                            else if (ViewData["CurrentSort"].ToString() == "EmailDesc")
                            {
                                <i class="fas fa-angle-double-up"></i>
                            }
                            else
                            {
                                <i class="fas fa-angle-double-right"></i>
                            }
                        }
                        else
                        {
                            <i class="fas fa-angle-double-left"></i>
                        }
                    </th>

                    <th>Yetkileri</th>
                    <th>Yetki Yönet</th>

                </tr>
            </thead>

            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>@item.Students.studentName</td>
                        <td>@item.Students.studentSurname</td>
                        <td>@item.Students.studentNumber</td>
                        <td>@item.Students.studentFacultyName</td>
                        <td>@item.Students.studentDepartment</td>
                        <td>@item.Email</td>

                        @await Component.InvokeAsync("AssignRolellist", new { id = item.Id })



                    </tr>
                }
            </tbody>
        </table>
    </div>

</div>


@using (Html.BeginForm("Index", "Home", FormMethod.Get, new { id = "form1" }))
{
    <input type="hidden" name="SearchString" value="@ViewData["CurrentFilterSearch"]" />
    <div class="pager">
        Sayfa @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) / @Model.PageCount<br />

        @Html.PagedListPager(Model, page => Url.Action("Index", new {page, pageSize = ViewBag.psize , SearchString = ViewData["CurrentFilterSearch"], sortOrder = @ViewData["CurrentSort"]}))
        @Html.DropDownList("pageSize")
    </div>
}
<script src="~/lib/jquery/dist/jquery.js" type="text/javascript"></script>
<script>
    $(document).ready(function() {
        $("#checkAll").click(function() {
            if (this.checked) {
                $(".chkbox").prop('checked', $(this).prop('checked', true));
            }
            else {
                $('.chkbox').each(function() { this.checked = false; });
            }
        });
        $('.chkbox').on('click', function() {
            if ($('.chkbox:checked').length == $('.chkbox').length) {
                $('#checkAll').prop('checked', true);
            } else {
                $('#checkAll').prop('checked', false);
            }
        });
    });
</script>
<script type="text/javascript">
    $(function() {
        $("#pageSize").change(function() {
            $("#form1").submit();
        });
    });
</script>
